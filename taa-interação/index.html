<!DOCTYPE html>
<html>
<head>
  <title>Teste de Arrumação do Armário</title>
  <link rel="stylesheet" type="text/css" href="assets/css/game.css" />
  <script type="text/javascript" src="assets/js/fases.js"></script>
  <script type="text/javascript" src="assets/js/objeto.js"></script>
  <script type="text/javascript" src="assets/js/porta.js"></script>
  <script type="text/javascript" src="assets/js/pontuacao.js"></script>
  <script type="text/javascript" src="assets/js/cenas.js"></script>
  <script type="text/javascript" src="lib/createjs-2015.05.21.min.js"></script>
  <script type="text/javascript" src="lib/minified-web.js"></script>
</head>
<body onload="init();">

<div class="mensagem embranco">
</div>

<div class="mensagem pt msgload">
  <p>Carregando...</p>
  
  <div class="progressbar"><div></div></div>
</div>

<div class="mensagem en msgload">
  <p>Loading...</p>

  <div class="progressbar"><div></div></div>
</div>


<div class="mensagem pt msgintro">
	<p>Olá! Vamos arrumar o armário?</p>

	<p>Você observará alguns OBJETOS sendo guardados em PORTAS no armário. Memorize-os!<br/>
	Depois disso, você terá que lembrar qual OBJETO do conjunto foi guardado em qual PORTA.<br/>
	Basta pressionar o cursor no OBJETO e arrastar para a PORTA onde você acha que ela estava antes. Simples, não?</p>

	<p>Mas lembre-se: se você errar três combinações, seja de OBJETOS ou PORTAS, você perderá a vez.</p>

	<p>Exercite sua memória e veja o quão longe sua memória pode te levar.</p>

	<p>Pronto para começar?</p>

  <button onclick="mostraJogo();">Começar</button>
</div>

<div class="mensagem en msgintro">
  <p>Hello! Let's arrange the cabinet?</p>

  <p>You'll notice some OBJECTS being placed in DOORS. Memorize them!<br/>
    After that, you'll need to remember which OBJECT was placed in which DOOR.<br/>
    Just press the pointer on the OBJECT and drag to the DOOR you believe it was placed before. Simple, isn't it?</p>

  <p>But remember: if you miss three combinations, whether be OBJECT or DOOR, you'll loose the round.</p>

  <p>Exercise your memory and see how far it may lead you.</p>

  <p>Ready to begin?</p>

  <button onclick="mostraJogo();">Begin</button>
</div>

<div class="mensagem pt msgfim">
  Obrigado por participar!
</div>

<div class="mensagem en msgfim">
  Obrigado for participating!
</div>

<canvas id="canvas">
  
</canvas>

<script type="text/javascript">
  var MINI = require('minified');
  var _=MINI._, $=MINI.$, $$=MINI.$$, EE=MINI.EE, HTML=MINI.HTML;
  var stage;
  var manifest;

  //imagem do fundo
  var cozinha;
  var loader;

  //objetos do jogo e portas

  function init(){
    if (window.location.search === "?en") {
      mudaIdioma("en");
    }
    mostraMensagem("msgload");

    // cria a cena para guardar os objetos na tela
    stage = new createjs.Stage("canvas");
    createjs.Touch.enable(stage);
    stage.canvas.width = 800;
    stage.canvas.height = 600;

    manifest = [
      {src: "cozinha.jpg", id: "cozinha"},
      {src: "porta.png", id: "porta"},
    ];

    for (var i = 1; i <= 40; i++) {
      manifest.push({src: "objeto" + i + ".png", id: "objeto" + i});
    }

    loader = new createjs.LoadQueue(false);
    loader.addEventListener("progress", handleProgress);
    loader.addEventListener("complete", handleComplete);
    loader.loadManifest(manifest, true, "assets/images/");
  }

  function handleProgress() {
    $('.progressbar>div').each(function(e) {
      e.style.width = (loader.progress * 100) + "%";
    });
  }

  function handleComplete() {
    //mostra o fundo
    cozinha = new createjs.Bitmap(loader.getResult("cozinha"));
    stage.addChild(cozinha);
    
    inicializaPortas();
    demonstraFase(0);

    // redesenha a cena várias vezes por segundo
    createjs.Ticker.setFPS(60);
    createjs.Ticker.addEventListener("tick", stage);

    mostraMensagem("msgintro");
  }
</script>

</body>
</html>