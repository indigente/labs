<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta charset="UTF-8">
  <title>Teste de Arrumação do Armário</title>
  <link rel="stylesheet" type="text/css" href="assets/css/game.css" />
  <script type="text/javascript" src="lib/minified-web.js"></script>
  <script type="text/javascript">
    var MINI = require('minified');
    var _=MINI._, $=MINI.$, $$=MINI.$$, EE=MINI.EE, HTML=MINI.HTML;
  </script>
  <script type="text/javascript" src="lib/cookies.min.js"></script>
  <script type="text/javascript" src="lib/rng.js"></script>
  <script type="text/javascript" src="lib/createjs-2015.11.26.min.js"></script>
  <script type="text/javascript" src="lib/soundjs-0.6.2.min.js"></script>
  <script type="text/javascript" src="assets/js/l10n.js"></script>
  <script type="text/javascript" src="assets/js/audio.js"></script>
  <script type="text/javascript" src="assets/js/fases.js"></script>
  <script type="text/javascript" src="assets/js/objetocoords.js"></script>
  <script type="text/javascript" src="assets/js/objeto.js"></script>
  <script type="text/javascript" src="assets/js/porta.js"></script>
  <script type="text/javascript" src="assets/js/pontuacao.js"></script>
  <script type="text/javascript" src="assets/js/cenas.js"></script>
  <script type="text/javascript" src="assets/js/partida.js"></script>
  <script type="text/javascript" src="assets/js/form.js"></script>
</head>
<body onload="init();">

<div class="mensagem pt credits">
  <h2>Créditos</h2>
  <p><b>Game design</b>: Neander Abreu</p>
  <p><b>Programação</b>: Rodrigo Rocha, Diego Zabot, Marcos Mass</p>
  <p><b>Áudio</b>: Tharcísio Vaz</p>
  <p><b>Arte gráfica</b>: Daiane Mascarenhas</p>
  <p><b>Texto</b>: Rogério Lázaro Jr.</p>
  <p><b>Beta testing</b>: Rogério Lázaro Jr., Antonio Santana, Felipe Freitas</p>
  <button onclick="mostraMensagem('msgintro');">Voltar</button>
</div>

<div class="mensagem en credits">
  <h2>Credits</h2>
  <p><b>Game design</b>: Neander Abreu</p>
  <p><b>Programming</b>: Rodrigo Rocha, Diego Zabot, Marcos Mass</p>
  <p><b>Audio</b>: Tharcísio Vaz</p>
  <p><b>Visual art</b>: Daiane Mascarenhas</p>
  <p><b>Text</b>: Rogério Lázaro Jr.</p>
  <p><b>Beta testing</b>: Rogério Lázaro Jr., Antonio Santana, Felipe Freitas</p>
  <button onclick="mostraMensagem('msgintro');">Back</button>
</div>

<div class="mensagem embranco">
</div>

<div class="mensagem pt attention">
  <p>Atenção!</p>
</div>
<div class="mensagem en attention">
  <p>Attention!</p>
</div>

<div class="mensagem pt msgload">
  <p>Carregando...</p>

  <div class="progressbar"><div></div></div>
</div>

<div class="mensagem en msgload">
  <p>Loading...</p>

  <div class="progressbar"><div></div></div>
</div>

<div class="formulario pt">
  <div style="padding: 15px 15px 15px 15px; font-size: 16px; font-family: Arial;">
    <h1>Teste de Arrumação do Armário</h1>
    <h2>Preencha seus dados</h2>
    <table>
      <tr>
        <th>Nome completo</th><td><input name="nome" required></td>
      </tr>
      <tr>
        <th>Sexo</th>
        <td><select name="sexo" required>
          <option disabled selected value="none">Escolha o sexo...</option>
          <option value="M">Masculino</option>
          <option value="F">Feminino</option>
        </select>
      </td>
    </tr>
    <tr>
      <th>Data de nascimento</th><td><input name="nascimento" type="date" required></td>
    </tr>
    <tr>
      <th>Escolaridade</th>
      <td><select name="escolaridade" required>
        <option disabled selected value="none">Escolha a escolaridade...</option>
        <option value="EF1">Ensino Fundamental I</option>
        <option value="EF2">Ensino Fundamental II</option>
        <option value="EM">Ensino Médio</option>
        <option value="ES">Ensino Superior</option>
        <option value="PS">Pós-Graduação</option>
      </select>
    </td>
  </tr>
  <tr>
    <th>Local de aplicação</th>
    <td>
      <select name="local">
        <option disabled selected value="none">Escolha o estado...</option>
        <option value="AC">AC</option>
        <option value="AL">AL</option>
        <option value="AP">AP</option>
        <option value="AM">AM</option>
        <option value="BA">BA</option>
        <option value="CE">CE</option>
        <option value="DF">DF</option>
        <option value="ES">ES</option>
        <option value="GO">GO</option>
        <option value="MA">MA</option>
        <option value="MT">MT</option>
        <option value="MS">MS</option>
        <option value="MG">MG</option>
        <option value="PA">PA</option>
        <option value="PB">PB</option>
        <option value="PR">PR</option>
        <option value="PE">PE</option>
        <option value="PI">PI</option>
        <option value="RJ">RJ</option>
        <option value="RN">RN</option>
        <option value="RS">RS</option>
        <option value="RO">RO</option>
        <option value="RR">RR</option>
        <option value="SC">SC</option>
        <option value="SP">SP</option>
        <option value="SE">SE</option>
        <option value="TO">TO</option>
      </select>
    </td>
  </tr>

  <tr>
    <td></td>
    <td>
      <p></p>
      <button onclick="validaForm();">Começar</button>
    </td>
  </tr>

</table>
  </div>
</div>

<div class="formulario en">
  <div style="padding: 15px 15px 15px 15px; font-size: 16px; font-family: Arial;">
    <h1>Kitchen Arrangement Test</h1>
    <h2>Fill in the form</h2>
    <table>
      <tr>
        <th>Full name</th><td><input name="nome" required></td>
      </tr>
      <tr>
        <th>Gender</th>
        <td><select name="sexo" required>
          <option disabled selected value="none">Choose your gender...</option>
          <option value="M">Male</option>
          <option value="F">Female</option>
        </select>
      </td>
    </tr>
    <tr>
      <th>Birthdate</th><td><input name="nascimento" type="date" required></td>
    </tr>
    <tr>
      <th>Educational level</th>
      <td><select name="escolaridade" required>
        <option disabled selected value="none">Choose your educational level...</option>
        <option value="EF1">Incomplete primary school</option>
        <option value="EF2">Primary school</option>
        <option value="EM">Secondary school</option>
        <option value="ES">Higher education</option>
        <option value="PS">Post-graduate school</option>
      </select>
    </td>
  </tr>
  <input type="hidden" name="local" value="OutsideBR" />
  <tr>
    <td></td>
    <td>
      <p></p>
      <button onclick="validaForm();">Begin</button>
    </td>
  </tr>

</table>
  </div>
</div>

<div class="mensagem pt msgintro">
	<p>Olá! Vamos arrumar o armário?</p>

	<p>Você observará alguns OBJETOS sendo guardados em PORTAS no armário. Memorize-os!<br/>
	Depois disso, você terá que lembrar qual OBJETO do conjunto foi guardado em qual PORTA.<br/>
	Basta pressionar o cursor no OBJETO e arrastar para a PORTA onde você acha que ela estava antes. Simples, não?</p>

	<p>Mas lembre-se: se você errar três combinações, seja de OBJETOS ou PORTAS, você perderá a vez.</p>

	<p>Exercite sua memória e veja o quão longe sua memória pode te levar.</p>

	<p>Pronto para começar?</p>

  <button onclick="mostraJogo();">Começar</button>
  <button onclick="mostraMensagem('credits');">Créditos</button>
</div>

<div class="mensagem en msgintro">
  <p>Hello! Let's arrange the cabinet?</p>

  <p>You'll notice some OBJECTS being placed in DOORS. Memorize them!<br/>
    After that, you'll need to remember which OBJECT was placed in which DOOR.<br/>
    Just press the pointer on the OBJECT and drag to the DOOR you believe it was placed before. Simple, isn't it?</p>

  <p>But remember: if you miss three combinations, whether be OBJECT or DOOR, you'll loose the round.</p>

  <p>Exercise your memory and see how far it may lead you.</p>

  <p>Ready to begin?</p>

  <button onclick="mostraFormulario();">Begin</button>
  <button onclick="mostraMensagem('credits');">Credits</button>
</div>

<div class="mensagem pt msgfim">
  Obrigado por participar!
</div>

<div class="mensagem en msgfim">
  Obrigado for participating!
</div>

<canvas id="canvas">

</canvas>

<script type="text/javascript">
  var stage;
  var manifest;

  //imagem do fundo
  var cozinha;
  var loader;

  //objetos do jogo e portas

  function resizeCanvas() {
    var rw = 800;
    var rh = 600;
    var w = window.innerWidth;
    var h = window.innerHeight;
    var multiplier = Math.min((h / rh), (w / rw));
    var actualCanvasWidth = rw * multiplier - 2;
    var actualCanvasHeight = rh * multiplier - 2;
    var canvas = $('#canvas')[0];
    canvas.style.width = actualCanvasWidth + "px";
    canvas.style.height = actualCanvasHeight + "px";
    $(".mensagem").each(function (div) {
      div.style.width = actualCanvasWidth + "px";
      div.style.height = actualCanvasHeight + "px";
    });
  }
  window.addEventListener('resize', resizeCanvas, true);

  function init(){
    if (window.location.search === "?en") {
      mudaIdioma("en");
    }
    mostraMensagem("msgload");

    // cria a cena para guardar os objetos na tela
    stage = new createjs.Stage("canvas");
    createjs.Touch.enable(stage, true);
    stage.canvas.width = 800;
    stage.canvas.height = 600;
    resizeCanvas();

    manifest = [
      {src: "images/cozinha.jpg", id: "cozinha"},
      {src: "images/porta.png", id: "porta"},
      {src: "images/images.png", id: "images"}
    ];

    createjs.Sound.registerSound("assets/fx/porta-abrindo.mp3", "porta-abrindo");
    createjs.Sound.registerSound("assets/fx/porta-fechando.mp3", "porta-fechando");
    createjs.Sound.registerSound("assets/fx/posiciona-alimento.mp3", "posiciona-alimento");
    createjs.Sound.registerSound("assets/fx/posiciona-obj-duro.mp3", "posiciona-obj-duro");
    createjs.Sound.registerSound("assets/fx/posiciona-talher.mp3", "posiciona-talher");
    createjs.Sound.registerSound("assets/fx/posiciona-vidro.mp3", "posiciona-vidro");
    createjs.Sound.registerSound("assets/fx/todas-portas-abrindo.mp3", "todas-portas-abrindo");
    createjs.Sound.registerSound("assets/fx/todas-portas-fechando.mp3", "todas-portas-fechando");

    loader = new createjs.LoadQueue(false);
    loader.addEventListener("progress", handleProgress);
    loader.addEventListener("complete", handleComplete);
    loader.loadManifest(manifest, true, "assets/");
  }

  function handleProgress() {
    $('.progressbar>div').each(function(e) {
      e.style.width = (loader.progress * 100) + "%";
    });
  }

  function handleComplete() {
    //mostra o fundo
    cozinha = new createjs.Bitmap(loader.getResult("cozinha"));
    stage.addChild(cozinha);

    inicializaPortas();
    //demonstraFase(0);

    // redesenha a cena várias vezes por segundo
    createjs.Ticker.setFPS(60);
    createjs.Ticker.addEventListener("tick", stage);

    // mostraMensagem("msgintro");
    // mostraFormulario();
    var userdata = Cookies.get('userdata');
    if (userdata) {
      dadosUsuario = JSON.parse(userdata);
      Cookies.expire('userdata');
    }
    mostraJogo();
  }
</script>

</body>
</html>
